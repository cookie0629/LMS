# LMS 项目移植路线图 - 渐进式Git提交模式

## 📋 目录
1. [移植策略](#移植策略)
2. [整体架构分析](#整体架构分析)
3. [移植阶段划分](#移植阶段划分)
4. [详细移植计划](#详细移植计划)
5. [Git提交规划](#git提交规划)

---

## 移植策略

### 核心原则

1. **渐进式移植**：每次只移植一个小模块或功能
2. **Git驱动开发**：每个可运行的功能立即提交
3. **理解优先**：理解每一行代码，不直接复制
4. **小步快跑**：保持每天2-3个有意义的提交

### 参考项目信息

- **参考项目路径**：`模板/`（仅供分析，不直接复制）
- **我的项目路径**：`E:\LightweightMusicServer\`
- **Git仓库**：已初始化

---

## 整体架构分析

### 参考项目模块依赖关系

```
┌─────────────────────────────────────────┐
│         Web UI Layer                    │
│  (依赖: Services, Database, Core)       │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│         Services Layer                  │
│  (依赖: Database, Audio, Image, Core)   │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│         Core Libraries                  │
│  (独立，不依赖其他业务模块)                │
│  - Core (工具库)                         │
│  - Database (数据库抽象)                 │
│  - Audio (音频处理)                      │
│  - Image (图像处理)                      │
└─────────────────────────────────────────┘
```

### 移植优先级（从底层到上层）

1. **Core 库** - 基础工具，无依赖
2. **Database 库** - 数据抽象层
3. **Audio 库** - 音频处理
4. **Image 库** - 图像处理
5. **Services** - 业务服务（依赖上述库）
6. **UI 层** - Web界面（依赖所有）

---

## 移植阶段划分

### 阶段 0：项目基础 ✅（已完成）

- [x] 项目目录结构
- [x] CMakeLists.txt 基础配置
- [x] 环境搭建
- [x] 基础 main.cpp

### 阶段 1：Core 库基础（当前阶段）

**目标**：实现基础工具库，为其他模块提供支持

**预计提交数**：8-10个

### 阶段 2：配置和日志系统

**目标**：实现配置管理和日志系统

**预计提交数**：5-6个

### 阶段 3：数据库基础

**目标**：实现数据库抽象层和基本数据模型

**预计提交数**：10-12个

### 阶段 4：音频处理基础

**目标**：实现音频文件读取和元数据解析

**预计提交数**：8-10个

### 阶段 5：扫描服务基础

**目标**：实现文件扫描和数据库更新

**预计提交数**：12-15个

### 阶段 6：Web UI 基础

**目标**：实现基本的Web界面

**预计提交数**：15-20个

### 阶段 7：播放功能

**目标**：实现音频播放和播放队列

**预计提交数**：8-10个

### 阶段 8：高级功能

**目标**：转码、推荐、搜索等

**预计提交数**：20+个

---

## 详细移植计划

## 阶段 1：Core 库基础（当前）

### 1.1 Path 工具类

**提交 1**：`feat: 添加Path工具类基础功能`
- 创建 `src/libs/core/include/core/Path.hpp`
- 实现 `exists()`, `isDirectory()`, `isFile()`
- 创建 `src/libs/core/impl/Path.cpp`
- 更新 CMakeLists.txt

**提交 2**：`feat: 添加Path工具类路径操作方法`
- 实现 `getFilename()`, `getExtension()`, `getParent()`
- 实现 `combine()` 路径拼接

**提交 3**：`feat: 添加Path工具类扩展功能`
- 实现 `hasFileAnyExtension()`（用于音频文件识别）
- 实现 `sanitizeFileStem()`（文件名清理）

**提交 4**：`test: 添加Path工具类单元测试`
- 创建测试文件
- 测试所有功能
- 测试边界情况

### 1.2 String 工具类

**提交 5**：`feat: 添加String工具类基础功能`
- 实现字符串大小写转换
- 实现字符串分割
- 实现 trim 功能

**提交 6**：`feat: 添加String工具类高级功能`
- 实现字符串格式化
- 实现编码转换（如果需要）

### 1.3 UUID 生成

**提交 7**：`feat: 实现UUID生成功能`
- 实现 UUID v4 生成
- 集成到项目中

### 1.4 Core 库集成

**提交 8**：`feat: 完成Core库基础功能并集成`
- 更新 CMakeLists.txt
- 创建 Core 库的导出接口
- 在 main.cpp 中测试使用

---

## 阶段 2：配置和日志系统

### 2.1 配置系统

**提交 9**：`feat: 实现配置系统接口定义`
- 创建 `IConfig.hpp` 接口
- 定义配置访问方法

**提交 10**：`feat: 实现配置文件读取功能`
- 实现配置解析
- 支持默认值

**提交 11**：`feat: 集成配置系统到主程序`
- 在 main.cpp 中加载配置
- 测试配置读取

### 2.2 日志系统

**提交 12**：`feat: 实现日志系统接口`
- 创建 `ILogger.hpp` 接口
- 定义日志级别

**提交 13**：`feat: 实现日志系统功能`
- 实现文件和控制台输出
- 实现日志格式化

**提交 14**：`feat: 添加日志宏和集成`
- 创建日志宏
- 集成到项目中

---

## 阶段 3：数据库基础

### 3.1 数据库接口

**提交 15**：`feat: 实现数据库接口定义`
- 创建 `IDb.hpp` 接口
- 定义数据库操作

**提交 16**：`feat: 实现数据库连接和会话管理`
- 实现数据库连接
- 实现会话管理

### 3.2 数据模型

**提交 17**：`feat: 实现User数据模型`
- 定义 User 类
- 实现 ORM 映射

**提交 18**：`feat: 实现Track数据模型`
- 定义 Track 类
- 实现基本关系

**提交 19**：`feat: 实现Artist和Release数据模型`
- 定义 Artist 和 Release 类
- 实现关系映射

**提交 20**：`feat: 实现数据库迁移系统`
- 实现迁移机制
- 创建初始迁移

---

## Git提交规划

### 提交信息规范

**格式**：
```
<type>: <subject>

<body>

<footer>
```

**类型（type）**：
- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `test`: 测试相关
- `refactor`: 重构
- `chore`: 构建/工具相关

**示例**：
```
feat: 实现Path工具类基础功能

- 添加 exists(), isDirectory(), isFile() 方法
- 使用 std::filesystem 实现跨平台支持
- 创建 Path.hpp 和 Path.cpp 文件

Related: Core库基础
Tests: 已添加基础测试
```

### 提交频率目标

- **每天**：2-3个有意义的提交
- **每周**：10-15个提交
- **每个功能**：1个提交（小功能）或2-3个提交（大功能）

### 提交检查清单

每次提交前检查：
- [ ] 代码可以编译
- [ ] 功能可以运行
- [ ] 提交信息清晰
- [ ] 没有临时文件
- [ ] 代码格式正确

---

## 当前任务：阶段 1.1 - Path 工具类

### 下一步行动

1. **创建文件结构**
2. **实现基础功能**（提交1）
3. **实现路径操作**（提交2）
4. **实现扩展功能**（提交3）
5. **添加测试**（提交4）

### 第一个提交准备

**提交信息**：
```
feat: 实现Path工具类基础功能

- 创建 pathUtils 命名空间
- 实现 exists(), isDirectory(), isFile() 方法
- 使用 std::filesystem 实现跨平台支持
- 创建 src/libs/core/include/core/Path.hpp
- 创建 src/libs/core/impl/Path.cpp
- 更新 src/libs/core/CMakeLists.txt

Related: 阶段1-Core库基础
```

---

## 进度跟踪

### 已完成提交
- （待开始）

### 待提交任务
- [ ] 提交1: Path工具类基础功能
- [ ] 提交2: Path工具类路径操作
- [ ] 提交3: Path工具类扩展功能
- [ ] 提交4: Path工具类测试

---

**最后更新**：2024-11-22

