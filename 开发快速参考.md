# LMS å¼€å‘å¿«é€Ÿå‚è€ƒå¡ç‰‡

## ğŸš€ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### æ„å»ºå’Œç¼–è¯‘

```bash
# é…ç½®ï¼ˆé¦–æ¬¡æˆ–ä¿®æ”¹ CMakeLists.txt åï¼‰
cd build && cmake .. -DCMAKE_BUILD_TYPE=Debug

# ç¼–è¯‘
make -j$(nproc)

# æ¸…ç†
make clean

# åªç¼–è¯‘ç‰¹å®šç›®æ ‡
make lms

# é‡æ–°é…ç½®
rm -rf build/* && cmake .. -DCMAKE_BUILD_TYPE=Debug
```

### ä»£ç æ ¼å¼åŒ–

```bash
# æ ¼å¼åŒ–å•ä¸ªæ–‡ä»¶
clang-format -i src/path/to/file.cpp

# æ ¼å¼åŒ–æ•´ä¸ªé¡¹ç›®
find src -name "*.cpp" -o -name "*.hpp" | xargs clang-format -i

# æ£€æŸ¥æ ¼å¼
clang-format --dry-run --Werror src/path/to/file.cpp
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cd build && ctest

# è¯¦ç»†è¾“å‡º
ctest --verbose

# è¿è¡Œç‰¹å®šæµ‹è¯•
ctest -R TestName

# å¹¶è¡Œè¿è¡Œ
ctest -j$(nproc)
```

### è°ƒè¯•

```bash
# GDB è°ƒè¯•
gdb ./build/src/lms/lms
(gdb) set args conf/lms.conf
(gdb) break main
(gdb) run

# æŸ¥çœ‹æ—¥å¿—
tail -f /var/lms/lms.log

# å†…å­˜æ£€æŸ¥
valgrind --leak-check=full ./build/src/lms/lms conf/lms.conf
```

### Git æ“ä½œ

```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/my-feature

# æŸ¥çœ‹çŠ¶æ€
git status

# æŸ¥çœ‹å·®å¼‚
git diff

# æ·»åŠ æ–‡ä»¶
git add src/path/to/file.cpp

# æäº¤
git commit -m "feat: åŠŸèƒ½æè¿°"

# æ¨é€åˆ°è¿œç¨‹
git push origin feature/my-feature
```

---

## ğŸ“ é¡¹ç›®ç»“æ„é€ŸæŸ¥

```
src/
â”œâ”€â”€ libs/              # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ audio/         # éŸ³é¢‘å¤„ç†
â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒå·¥å…·
â”‚   â”œâ”€â”€ database/      # æ•°æ®åº“å±‚
â”‚   â”œâ”€â”€ services/      # ä¸šåŠ¡æœåŠ¡
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lms/               # ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ main.cpp       # å…¥å£
â”‚   â””â”€â”€ ui/            # Web UI
â””â”€â”€ tools/             # å·¥å…·ç¨‹åº
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | ä½ç½® | ç”¨é€” |
|------|------|------|
| `lms.conf` | `conf/lms.conf` | ä¸»é…ç½®æ–‡ä»¶ |
| `.clang-format` | æ ¹ç›®å½• | ä»£ç æ ¼å¼è§„èŒƒ |
| `.clang-tidy` | æ ¹ç›®å½• | ä»£ç æ£€æŸ¥è§„åˆ™ |
| `CMakeLists.txt` | å„ç›®å½• | æ„å»ºé…ç½® |

---

## ğŸ“ ä»£ç æ¨¡æ¿

### æ–°ç±»æ¨¡æ¿

```cpp
#pragma once

#include <memory>

namespace lms::module
{
    class IMyClass
    {
    public:
        virtual ~IMyClass() = default;
        virtual void doSomething() = 0;
    };

    std::unique_ptr<IMyClass> createMyClass();
}
```

### æ—¥å¿—ä½¿ç”¨

```cpp
#include "core/ILogger.hpp"

LMS_LOG(MODULE, INFO, "ä¿¡æ¯");
LMS_LOG(MODULE, DEBUG, "è°ƒè¯•: " << variable);
LMS_LOG(MODULE, ERROR, "é”™è¯¯: " << error);
```

### å¼‚å¸¸å¤„ç†

```cpp
try
{
    // ä»£ç 
}
catch (const std::exception& e)
{
    LMS_LOG(MODULE, ERROR, "Exception: " << e.what());
    // å¤„ç†
}
```

---

## ğŸ› å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³

### ç¼–è¯‘é”™è¯¯ï¼šæ‰¾ä¸åˆ°åº“

```bash
# æ£€æŸ¥åº“æ˜¯å¦å­˜åœ¨
ldconfig -p | grep library_name

# æ›´æ–°åº“ç¼“å­˜
sudo ldconfig
```

### è¿è¡Œæ—¶é”™è¯¯ï¼šæ— æ³•æ‰“å¼€æ•°æ®åº“

```bash
# æ£€æŸ¥æƒé™
ls -la /var/lms

# ä¿®å¤æƒé™
sudo chown -R $USER:$USER /var/lms
```

### æ‰¾ä¸åˆ°å¤´æ–‡ä»¶

```bash
# æ£€æŸ¥åŒ…å«è·¯å¾„
cmake .. --debug-output 2>&1 | grep include
```

---

## ğŸ“š é‡è¦æ–‡ä»¶è·¯å¾„

| æ–‡ä»¶/ç›®å½• | è·¯å¾„ |
|-----------|------|
| ç¨‹åºå…¥å£ | `src/lms/main.cpp` |
| é…ç½®æ–‡ä»¶ | `conf/lms.conf` |
| æ•°æ®åº“å¯¹è±¡ | `src/libs/database/include/database/objects/` |
| éŸ³é¢‘æ¥å£ | `src/libs/audio/include/audio/` |
| æ‰«ææœåŠ¡ | `src/libs/services/scanner/` |
| Web UI æ¨¡æ¿ | `approot/*.xml` |
| é™æ€èµ„æº | `docroot/` |

---

## ğŸ¯ å¼€å‘å·¥ä½œæµ

```
1. åˆ›å»ºåˆ†æ”¯
   git checkout -b feature/my-feature

2. ç¼–å†™ä»£ç 
   vim src/path/to/file.cpp

3. æ ¼å¼åŒ–
   clang-format -i src/path/to/file.cpp

4. ç¼–è¯‘
   cd build && make -j$(nproc)

5. æµ‹è¯•
   ctest

6. æäº¤
   git add . && git commit -m "feat: æè¿°"
```

---

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### è®¾ç½®æ–­ç‚¹

```cpp
// åœ¨ä»£ç ä¸­æ·»åŠ 
#ifdef DEBUG
    __builtin_trap();  // è§¦å‘æ–­ç‚¹
#endif
```

### æ‰“å°è°ƒè¯•ä¿¡æ¯

```cpp
LMS_LOG(MODULE, DEBUG, "å˜é‡å€¼: " << variable);
std::cerr << "è°ƒè¯•: " << value << std::endl;
```

### æŸ¥çœ‹è°ƒç”¨æ ˆ

```bash
# ä½¿ç”¨ GDB
(gdb) backtrace
(gdb) frame 1
```

---

## ğŸ” ä»£ç æœç´¢

```bash
# æœç´¢å‡½æ•°
grep -r "function_name" src/

# æœç´¢åŒ…å«
grep -r "#include.*header" src/

# ä½¿ç”¨ ripgrepï¼ˆæ›´å¿«ï¼‰
rg "pattern" src/
```

---

## ğŸ“– æ–‡æ¡£é“¾æ¥

- **è¯¦ç»†å¼€å‘æŒ‡å—**ï¼š`è¯¦ç»†å¼€å‘æ­¥éª¤æŒ‡å—.md`
- **å¿«é€Ÿå…¥é—¨**ï¼š`å¿«é€Ÿå…¥é—¨æŒ‡å—.md`
- **é¡¹ç›®å­¦ä¹ **ï¼š`é¡¹ç›®å­¦ä¹ æŒ‡å—.md`
- **æ•…éšœæ’é™¤**ï¼š`æ•…éšœæ’é™¤æŒ‡å—.md`

---

**æç¤º**ï¼šå°†æ­¤æ–‡ä»¶ä¿å­˜åœ¨æ‰‹è¾¹ï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥é˜…ï¼ğŸ“Œ

