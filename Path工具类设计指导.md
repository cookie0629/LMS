# Path å·¥å…·ç±»è®¾è®¡æŒ‡å¯¼

## ğŸ“‹ ç›®å½•
1. [æ¨¡æ¿è®¾è®¡æ€è·¯åˆ†æ](#æ¨¡æ¿è®¾è®¡æ€è·¯åˆ†æ)
2. [æ¥å£è®¾è®¡å»ºè®®](#æ¥å£è®¾è®¡å»ºè®®)
3. [å®ç°æ­¥éª¤](#å®ç°æ­¥éª¤)
4. [å­¦ä¹ è¦ç‚¹](#å­¦ä¹ è¦ç‚¹)

---

## æ¨¡æ¿è®¾è®¡æ€è·¯åˆ†æ

### ğŸ¯ è®¾è®¡ç›®çš„

æ¨¡æ¿ä¸­çš„ Path å·¥å…·ç±»ï¼ˆ`pathUtils` å‘½åç©ºé—´ï¼‰ä¸»è¦æä¾›ï¼š

1. **è·¯å¾„å·¥å…·å‡½æ•°é›†åˆ**ï¼šä¸æ˜¯ç±»ï¼Œè€Œæ˜¯ä¸€ç»„å·¥å…·å‡½æ•°
2. **æ–‡ä»¶ç³»ç»Ÿæ“ä½œè¾…åŠ©**ï¼šç®€åŒ–å¸¸è§çš„è·¯å¾„æ“ä½œ
3. **è·¨å¹³å°æ”¯æŒ**ï¼šä½¿ç”¨ C++17 çš„ `std::filesystem`

### ğŸ“¦ æ ¸å¿ƒåŠŸèƒ½åˆ†æ

æ¨¡æ¿æä¾›äº†ä»¥ä¸‹å·¥å…·å‡½æ•°ï¼š

#### 1. `hasFileAnyExtension()`
- **åŠŸèƒ½**ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ‰æŒ‡å®šçš„æ‰©å±•åä¹‹ä¸€
- **ç”¨é€”**ï¼šåœ¨æ‰«ææ—¶åˆ¤æ–­æ˜¯å¦ä¸ºéŸ³é¢‘æ–‡ä»¶
- **è®¾è®¡æ€è·¯**ï¼šæ¥å—æ‰©å±•ååˆ—è¡¨ï¼Œä½¿ç”¨ `std::span` ä¼ é€’

#### 2. `isPathInRootPath()`
- **åŠŸèƒ½**ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦åœ¨æ ¹è·¯å¾„å†…
- **ç”¨é€”**ï¼šå®‰å…¨éªŒè¯ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»
- **è®¾è®¡æ€è·¯**ï¼šæ”¯æŒæ’é™¤ç‰¹å®šç›®å½•å

#### 3. `getLongestCommonPath()`
- **åŠŸèƒ½**ï¼šè·å–ä¸¤ä¸ªè·¯å¾„çš„æœ€é•¿å…¬å…±è·¯å¾„
- **ç”¨é€”**ï¼šæ‰¾åˆ°è‰ºæœ¯å®¶çš„å…±åŒç›®å½•
- **è®¾è®¡æ€è·¯**ï¼šé€çº§æ¯”è¾ƒè·¯å¾„ç»„ä»¶

#### 4. `sanitizeFileStem()`
- **åŠŸèƒ½**ï¼šæ¸…ç†æ–‡ä»¶åï¼Œç§»é™¤éæ³•å­—ç¬¦
- **ç”¨é€”**ï¼šç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
- **è®¾è®¡æ€è·¯**ï¼šä¿ç•™ UTF-8ï¼Œç§»é™¤éæ³• ASCII å­—ç¬¦

### ğŸ—ï¸ è®¾è®¡æ¨¡å¼

æ¨¡æ¿é‡‡ç”¨äº†**å·¥å…·å‡½æ•°å‘½åç©ºé—´**æ¨¡å¼ï¼Œè€Œä¸æ˜¯ç±»ï¼š

```cpp
namespace lms::core::pathUtils
{
    // å·¥å…·å‡½æ•°
}
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•ç›´æ¥ï¼Œä¸éœ€è¦å®ä¾‹åŒ–
- å‡½æ•°å¼ç¼–ç¨‹é£æ ¼
- æ˜“äºä½¿ç”¨

**æ›¿ä»£æ–¹æ¡ˆ**ï¼ˆä½ ä¹Ÿå¯ä»¥è€ƒè™‘ï¼‰ï¼š
- é™æ€ç±»ï¼š`Path::exists()`
- å•ä¾‹æ¨¡å¼ï¼š`Path::getInstance()->exists()`
- æ¥å£æ¨¡å¼ï¼š`IPath` æ¥å£ + å®ç°ç±»

---

## æ¥å£è®¾è®¡å»ºè®®

### æ–¹æ¡ˆ 1ï¼šå·¥å…·å‡½æ•°å‘½åç©ºé—´ï¼ˆå‚è€ƒæ¨¡æ¿ï¼‰

```cpp
namespace lms::core::pathUtils
{
    // åŸºç¡€æ“ä½œ
    bool exists(const std::filesystem::path& path);
    bool isDirectory(const std::filesystem::path& path);
    bool isFile(const std::filesystem::path& path);
    
    // è·¯å¾„æ“ä½œ
    std::filesystem::path getParent(const std::filesystem::path& path);
    std::string getFilename(const std::filesystem::path& path);
    std::string getExtension(const std::filesystem::path& path);
    
    // æ–‡ä»¶æ“ä½œ
    std::filesystem::path combine(const std::filesystem::path& p1, const std::filesystem::path& p2);
}
```

### æ–¹æ¡ˆ 2ï¼šPath ç±»å°è£…ï¼ˆæ›´é¢å‘å¯¹è±¡ï¼‰

```cpp
namespace lms::core
{
    class Path
    {
    public:
        Path(const std::filesystem::path& path);
        
        // æŸ¥è¯¢æ“ä½œ
        bool exists() const;
        bool isDirectory() const;
        bool isFile() const;
        
        // è·¯å¾„æ“ä½œ
        Path getParent() const;
        std::string getFilename() const;
        std::string getExtension() const;
        
        // è½¬æ¢
        std::string string() const;
        const std::filesystem::path& getPath() const;
        
    private:
        std::filesystem::path m_path;
    };
}
```

### ğŸ’¡ æˆ‘çš„å»ºè®®

**å¯¹äºåˆå­¦è€…ï¼Œå»ºè®®ä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆå·¥å…·å‡½æ•°ï¼‰**ï¼š
- æ›´ç®€å•ï¼Œä¸éœ€è¦ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ
- ä¸æ¨¡æ¿é£æ ¼ä¸€è‡´
- æ˜“äºæµ‹è¯•å’Œä½¿ç”¨

**å¦‚æœä½ æƒ³è¦æ›´é¢å‘å¯¹è±¡çš„è®¾è®¡ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ¡ˆ 2**ï¼š
- æ›´ç¬¦åˆ C++ é¢å‘å¯¹è±¡é£æ ¼
- å¯ä»¥æ·»åŠ æ›´å¤šåŠŸèƒ½ï¼ˆå¦‚è·¯å¾„è§„èŒƒåŒ–ï¼‰
- å¯ä»¥é“¾å¼è°ƒç”¨

---

## å®ç°æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»ºç›®å½•ç»“æ„

```bash
mkdir -p src/libs/core/include/core
mkdir -p src/libs/core/impl
```

### æ­¥éª¤ 2ï¼šè®¾è®¡æ¥å£

åˆ›å»º `src/libs/core/include/core/Path.hpp`ï¼š

**æ€è€ƒé—®é¢˜**ï¼š
1. éœ€è¦å“ªäº›åŸºç¡€åŠŸèƒ½ï¼Ÿ
   - è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Ÿ
   - æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Ÿ
   - å¦‚ä½•è·å–æ–‡ä»¶åã€æ‰©å±•åï¼Ÿ
   - å¦‚ä½•æ‹¼æ¥è·¯å¾„ï¼Ÿ

2. å¦‚ä½•å¤„ç†é”™è¯¯ï¼Ÿ
   - æŠ›å‡ºå¼‚å¸¸ï¼Ÿ
   - è¿”å›é”™è¯¯ç ï¼Ÿ
   - ä½¿ç”¨ `std::error_code`ï¼Ÿ

3. ä½¿ç”¨ä»€ä¹ˆç±»å‹ï¼Ÿ
   - `std::filesystem::path`ï¼ˆæ¨èï¼‰
   - `std::string`ï¼ˆç®€å•ä½†ä¸å¤Ÿç±»å‹å®‰å…¨ï¼‰

### æ­¥éª¤ 3ï¼šå®ç°åŠŸèƒ½

åˆ›å»º `src/libs/core/impl/Path.cpp`ï¼š

**å®ç°è¦ç‚¹**ï¼š
- ä½¿ç”¨ C++17 çš„ `<filesystem>` æ ‡å‡†åº“
- å¤„ç†è·¨å¹³å°å·®å¼‚ï¼ˆWindows vs Linuxï¼‰
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†

### æ­¥éª¤ 4ï¼šæµ‹è¯•

åˆ›å»ºç®€å•çš„æµ‹è¯•ç¨‹åºéªŒè¯åŠŸèƒ½ã€‚

---

## å­¦ä¹ è¦ç‚¹

### 1. std::filesystem åŸºç¡€

```cpp
#include <filesystem>
namespace fs = std::filesystem;

// æ£€æŸ¥å­˜åœ¨
fs::exists(path)

// æ£€æŸ¥ç±»å‹
fs::is_directory(path)
fs::is_regular_file(path)

// è·¯å¾„æ“ä½œ
path.parent_path()      // çˆ¶ç›®å½•
path.filename()         // æ–‡ä»¶å
path.extension()        // æ‰©å±•å
path / "subdir"         // è·¯å¾„æ‹¼æ¥
```

### 2. é”™è¯¯å¤„ç†

```cpp
// æ–¹å¼ 1ï¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆé»˜è®¤ï¼‰
if (!fs::exists(path))
    throw std::runtime_error("Path does not exist");

// æ–¹å¼ 2ï¼šä½¿ç”¨ error_codeï¼ˆä¸æŠ›å¼‚å¸¸ï¼‰
std::error_code ec;
bool exists = fs::exists(path, ec);
if (ec)
    // å¤„ç†é”™è¯¯
```

### 3. è·¨å¹³å°è€ƒè™‘

- Windows ä½¿ç”¨åæ–œæ  `\`ï¼ŒLinux ä½¿ç”¨æ­£æ–œæ  `/`
- `std::filesystem::path` è‡ªåŠ¨å¤„ç†
- ä½†å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶è¦æ³¨æ„

---

## ä½ çš„ä»»åŠ¡

### ä»»åŠ¡ 1ï¼šè®¾è®¡æ¥å£

è¯·è®¾è®¡ä½ çš„ Path å·¥å…·ç±»æ¥å£ï¼Œè€ƒè™‘ï¼š

1. **åŸºç¡€åŠŸèƒ½**ï¼ˆå¿…é¡»ï¼‰ï¼š
   - [ ] æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨
   - [ ] åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•
   - [ ] è·å–æ–‡ä»¶å
   - [ ] è·å–æ‰©å±•å
   - [ ] è·¯å¾„æ‹¼æ¥

2. **æ‰©å±•åŠŸèƒ½**ï¼ˆå¯é€‰ï¼‰ï¼š
   - [ ] è·å–çˆ¶ç›®å½•
   - [ ] è§„èŒƒåŒ–è·¯å¾„
   - [ ] æ£€æŸ¥æ–‡ä»¶æ‰©å±•åï¼ˆç”¨äºéŸ³é¢‘æ–‡ä»¶è¯†åˆ«ï¼‰

3. **è®¾è®¡é€‰æ‹©**ï¼š
   - [ ] ä½¿ç”¨å·¥å…·å‡½æ•°å‘½åç©ºé—´ï¼Ÿ
   - [ ] ä½¿ç”¨ Path ç±»ï¼Ÿ
   - [ ] é”™è¯¯å¤„ç†æ–¹å¼ï¼Ÿ

### ä»»åŠ¡ 2ï¼šå±•ç¤ºä½ çš„è®¾è®¡

è®¾è®¡å®Œæˆåï¼Œè¯·å±•ç¤ºï¼š
- æ¥å£å®šä¹‰ï¼ˆå¤´æ–‡ä»¶å†…å®¹ï¼‰
- è®¾è®¡ç†ç”±ï¼ˆä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼‰

æˆ‘ä¼šå®¡æŸ¥å¹¶æä¾›å»ºè®®ï¼

---

## å‚è€ƒèµ„æº

- [C++17 Filesystem æ–‡æ¡£](https://en.cppreference.com/w/cpp/filesystem)
- æ¨¡æ¿å®ç°ï¼š`æ¨¡æ¿/src/libs/core/impl/Path.cpp`
- æ¨¡æ¿å¤´æ–‡ä»¶ï¼š`æ¨¡æ¿/src/libs/core/include/core/Path.hpp`

---

**ä¸‹ä¸€æ­¥**ï¼šè¯·è®¾è®¡ä½ çš„ Path æ¥å£ï¼Œç„¶åå±•ç¤ºç»™æˆ‘å®¡æŸ¥ï¼

